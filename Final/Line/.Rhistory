library(shiny)
library(ggplot2)
library(dplyr)
library(DT)
library(tidyr)
library(lubridate)
library(stringr)
sbi <- read.csv('D:/Desktop/Line/Youbike_sbi(1).csv')
sbi_line <- dsbi%>%gather( Time, value, X2018.8.1.7:X2018.8.4.9, na.rm = TRUE)
#sbi <- read.csv('D:/gitHub/NTU_R/Final/Youbike_sbi.csv')
#sbi_line <- sbi%>%gather( Time, value, X2018.8.1.7:X2018.8.1.24, na.rm = TRUE)
sbi_line<-select(sbi_line,sarea,Time,value)
sbi_line<-sbi_line%>%group_by(sarea,Time)%>%summarise(mean=mean(value))
sbi_line$Time <- str_replace(sbi_line$Time, 'X', '')
sbi_line$Time <- ymd_h(sbi_line$Time)
sbi_line<-separate(sbi_line,Time,c("day","hour"),sep=" ",remove=FALSE)
all_regions <- sort(unique(sbi_line$sarea))
shade <- read.csv('D:/Desktop/Line/shade.csv')
shade$x1<-ymd_h(shade$x1)
shade$x2<-ymd_h(shade$x2)
sbi <- read.csv('D:/Desktop/Line/Youbike_sbi(1).csv')
sbi_line <- sbi%>%gather( Time, value, X2018.8.1.7:X2018.8.4.9, na.rm = TRUE)
#sbi <- read.csv('D:/gitHub/NTU_R/Final/Youbike_sbi.csv')
#sbi_line <- sbi%>%gather( Time, value, X2018.8.1.7:X2018.8.1.24, na.rm = TRUE)
sbi_line<-select(sbi_line,sarea,Time,value)
sbi_line<-sbi_line%>%group_by(sarea,Time)%>%summarise(mean=mean(value))
sbi_line$Time <- str_replace(sbi_line$Time, 'X', '')
sbi_line$Time <- ymd_h(sbi_line$Time)
sbi_line<-separate(sbi_line,Time,c("day","hour"),sep=" ",remove=FALSE)
all_regions <- sort(unique(sbi_line$sarea))
shade <- read.csv('D:/Desktop/Line/shade.csv')
shade$x1<-ymd_h(shade$x1)
shade$x2<-ymd_h(shade$x2)
runApp()
runApp()
library(shiny)
library(ggplot2)
library(dplyr)
library(DT)
library(tidyr)
library(lubridate)
library(stringr)
sbi <- read.csv('D:/Desktop/Line/Youbike_sbi(1).csv')
sbi_line <- sbi %>% gather( Time, value, X2018.8.1.7:X2018.8.4.9, na.rm = TRUE)
sbi_line <- select(sbi_line,sarea,Time,value)
sbi_line <- sbi_line %>% group_by(sarea,Time) %>% summarise(mean=mean(value))
sbi_line$Time <- str_replace(sbi_line$Time, 'X', '')
sbi_line$Time <- ymd_h(sbi_line$Time)
sbi_line <- separate(sbi_line,Time,c("day","hour"),sep=" ",remove=FALSE)
all_regions <- sort(unique(sbi_line$sarea))
min_date <- min(sbi_line$Time)
max_date <- max(sbi_line$Time)
shade <- read.csv('D:/Desktop/Line/shade.csv')
shade$x1<-ymd_h(shade$x1)
shade$x2<-ymd_h(shade$x2)
View(sbi)
all_regions
runApp()
runApp()
runApp()
View(sbi_line)
runApp()
runApp()
min(sbi_line$Time)
max(sbi_line$Time)
View(sbi)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
sbi_line %>% filter(sarea == "南港區")
sbi <- read.csv('D:/Desktop/Line/Youbike_sbi(1).csv')
sbi_line <- sbi %>% gather( Time, value, X2018.8.1.7:X2018.8.4.9, na.rm = TRUE)
sbi_line <- select(sbi_line,sarea,Time,value)
sbi_line <- sbi_line %>% group_by(sarea,Time) %>% summarise(mean=mean(value))
sbi_line$Time <- str_replace(sbi_line$Time, 'X', '')
sbi_line$Time <- ymd_h(sbi_line$Time)
sbi_line <- separate(sbi_line,Time,c("day","hour"),sep=" ",remove=FALSE)
all_regions <- sort(unique(sbi_line$sarea))
min_date <- min(sbi_line$Time)
max_date <- max(sbi_line$Time)
shade <- read.csv('D:/Desktop/Line/shade.csv')
shade$x1<-ymd_h(shade$x1)
shade$x2<-ymd_h(shade$x2)
sbi_line %>% filter(sarea == "南港區")
z <- sbi_line %>% filter(sarea == "南港區")
View(z)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
View(z)
runApp()
sbi_line%>%filter(day=="2018-08-01")%>%ggplot(aes(x=Time,y=mean,color=sarea))+geom_line()+ylim(8,25)
sbi_line%>%filter(day=="2018-08-01",sarea=="大同區")%>%ggplot(aes(x=Time,y=mean,color=sarea))+geom_line()+ylim(8,25)
View(sbi_line)
ggplot() +
geom_line(aes(x=Time, y=mean, color=sarea),data=sbi_line)+
geom_rect(data=shade,
mapping=aes(xmin=x1, xmax=x2, ymin=-Inf, ymax=Inf), color='grey')
runApp()
View(sbi_line)
runApp()
filter(sarea == input$sarea) %>%
0
sbi_line %>%
filter(sarea == '南港區') %>%
filter(day >= '2018-08-01' & day <= '2018-08-02'
)
z <-> sbi_line %>%
+     filter(sarea == '南港區') %>%
+     filter(day >= '2018-08-01' & day <= '2018-08-02')
z <- sbi_line %>%
filter(sarea == '南港區') %>%
filter(day >= '2018-08-01' & day <= '2018-08-02')
View(z)
View(shade)
runApp()
runApp()
runApp()
runApp()
runApp()
selected <- sbi_line %>%
filter(sarea == '南港區') %>%
filter(day >= '2018-08-01' & day <= '2018-08-02')
View(selected)
ggplot() +
geom_line(aes(x=Time, y=mean), color='red',data=selected)+
geom_rect(data=shade,
mapping=aes(xmin=x1, xmax=x2, ymin=-Inf, ymax=Inf), color='grey')
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
